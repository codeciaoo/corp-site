---
import Layout from "../layouts/Layout.astro";
import Services from "../components/Home/Services";
import Strengths from "../components/Home/Strengths";
import ServiceComparisonTable from "../components/Home/ServiceComparisonTable";
import ContactFlow from "../components/Home/ContactFlow";
import HeroSection from "@/components/Home/Hero/HeroSection";
import Solutions from "@/components/Home/Solutions/Solutions";

import Section from "@/components/Section";
import Projects from "@/components/Projects";
import { getCollection } from "astro:content";

const projects = (await getCollection("projects")).slice(0, 3);
const sortedProjects = projects.sort(
  (a, b) => b.data.publishedDate.getTime() - a.data.publishedDate.getTime()
);
---

<Layout>
  <HeroSection client:load />

  <Section bg="light" ariaLabel="解決できる課題">
    <Solutions client:load />
  </Section>

  <Section bg="dark" ariaLabel="3つの強み">
    <Strengths client:idle />
  </Section>

  <Section bg="light" ariaLabel="実績">
    <Projects
      client:idle
      projects={sortedProjects.map(project => ({
        title: project.data.title,
        summary: project.data.summary,
        publishedDate: project.data.publishedDate,
        cover: project.data.cover.src,
        coverAlt: project.data.coverAlt,
        href: `/projects/${project.id}`,
      }))}
    />
    <!-- <Acheivements client:idle /> -->
  </Section>

  <Section bg="dark" ariaLabel="主要サービス">
    <Services client:visible />
  </Section>

  <Section bg="light" ariaLabel="契約プラン">
    <ServiceComparisonTable client:visible />
  </Section>

  <Section bg="dark" ariaLabel="お問い合わせから開始までの流れ">
    <ContactFlow client:visible />
  </Section>
</Layout>
